<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>استعادة كلمة المرور - المنصة الطبية</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- شريط التنقل -->
    <nav class="navbar">
        <div class="container">
            <a href="index.html" class="logo">
                <i class="fas fa-stethoscope"></i>
                <span>المنصة الطبية</span>
            </a>

            <button class="menu-toggle" id="menuToggle">
                <i class="fas fa-bars"></i>
            </button>

            <ul class="nav-links" id="navLinks">
                <li><a href="index.html"><i class="fas fa-home"></i> الرئيسية</a></li>
                <li><a href="about.html"><i class="fas fa-info-circle"></i> عن المنصة</a></li>
                <li><a href="services.html"><i class="fas fa-concierge-bell"></i> الخدمات</a></li>
                <li><a href="contact.html"><i class="fas fa-envelope"></i> اتصل بنا</a></li>
                <li><a href="login.html" class="btn-login"><i class="fas fa-sign-in-alt"></i> تسجيل الدخول</a></li>
            </ul>
        </div>
    </nav>

    <!-- قسم استعادة كلمة المرور -->
    <section class="auth-section">
        <div class="container">
            <div class="auth-container">
                <div class="auth-header">
                    <h1>استعادة كلمة المرور</h1>
                    <p>أدخل بريدك الإلكتروني لإرسال رابط استعادة كلمة المرور</p>
                </div>

                <form id="forgotPasswordForm" class="auth-form">
                    <div class="form-group">
                        <label for="resetEmail">البريد الإلكتروني *</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="resetEmail" required placeholder="أدخل بريدك الإلكتروني المسجل">
                        </div>
                        <div class="error-message" id="emailError"></div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block" id="resetBtn">
                        <span id="resetText">إرسال رابط الاستعادة</span>
                        <div class="spinner hidden" id="resetSpinner"></div>
                    </button>

                    <div class="auth-divider">
                        <span>أو</span>
                    </div>

                    <div class="additional-options">
                        <a href="login.html" class="btn btn-secondary btn-block">
                            <i class="fas fa-arrow-right"></i> العودة لتسجيل الدخول
                        </a>
                    </div>
                </form>

                <div class="auth-footer">
                    <p>لا تملك حساباً؟ <a href="register.html">أنشئ حساب جديد</a></p>
                    <p><a href="index.html"><i class="fas fa-arrow-right"></i> العودة للصفحة الرئيسية</a></p>
                </div>
            </div>
        </div>
    </section>

    <!-- الفوتر -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>© المنصة الطبية.</p>
                <p>© 2026 Designed By Emad Multimedia</p>
            </div>
        </div>
    </footer>

    <!-- نافذة التأكيد -->
    <div class="modal" id="resetModal">
        <div class="modal-content">
            <div class="modal-body text-center">
                <div class="success-icon">
                    <i class="fas fa-paper-plane"></i>
                </div>
                <h3>تم إرسال رابط الاستعادة!</h3>
                <p id="resetMessage">تم إرسال رابط استعادة كلمة المرور إلى بريدك الإلكتروني. يرجى التحقق من صندوق الوارد
                    ومتابعة التعليمات.</p>
                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="closeResetModal()">
                        <i class="fas fa-check"></i> حسناً
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="./js/auth.js"></script>
    <script>
        // تهيئة الصفحة
        document.addEventListener('DOMContentLoaded', function () {
            const menuToggle = document.getElementById('menuToggle');
            const navLinks = document.getElementById('navLinks');

            if (menuToggle && navLinks) {
                menuToggle.addEventListener('click', function () {
                    navLinks.classList.toggle('active');
                    menuToggle.innerHTML = navLinks.classList.contains('active')
                        ? '<i class="fas fa-times"></i>'
                        : '<i class="fas fa-bars"></i>';
                });
            }

            // معالجة استعادة كلمة المرور
            const forgotPasswordForm = document.getElementById('forgotPasswordForm');
            const resetBtn = document.getElementById('resetBtn');
            const resetText = document.getElementById('resetText');
            const resetSpinner = document.getElementById('resetSpinner');

            if (forgotPasswordForm && resetBtn) {
                forgotPasswordForm.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    const email = document.getElementById('resetEmail').value.trim();

                    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                        document.getElementById('emailError').textContent = 'الرجاء إدخال بريد إلكتروني صحيح';
                        return;
                    }

                    // التحقق من وجود البريد الإلكتروني
                    const users = JSON.parse(localStorage.getItem('medicalPlatformUsers') || '[]');
                    const userExists = users.some(user => user.email === email);

                    if (!userExists) {
                        document.getElementById('emailError').textContent = 'هذا البريد الإلكتروني غير مسجل';
                        return;
                    }

                    // عرض حالة التحميل
                    resetBtn.disabled = true;
                    resetText.style.display = 'none';
                    resetSpinner.classList.remove('hidden');

                    try {
                        // محاكاة إرسال البريد الإلكتروني
                        await new Promise(resolve => setTimeout(resolve, 1500));

                        // إظهار نافذة النجاح
                        showResetModal(email);

                    } catch (error) {
                        showNotification('حدث خطأ أثناء إرسال رابط الاستعادة', 'error');
                    } finally {
                        // إعادة تفعيل الزر
                        resetBtn.disabled = false;
                        resetText.style.display = 'block';
                        resetSpinner.classList.add('hidden');
                    }
                });
            }
        });

        // إظهار نافذة استعادة كلمة المرور
        function showResetModal(email) {
            const modal = document.getElementById('resetModal');
            const message = document.getElementById('resetMessage');

            if (modal && message) {
                message.textContent = `تم إرسال رابط استعادة كلمة المرور إلى ${email}. يرجى التحقق من صندوق الوارد ومتابعة التعليمات.`;

                modal.style.display = 'flex';
                setTimeout(() => {
                    modal.classList.add('active');
                }, 10);
            }
        }

        // إغلاق نافذة استعادة كلمة المرور
        function closeResetModal() {
            const modal = document.getElementById('resetModal');
            if (modal) {
                modal.classList.remove('active');
                setTimeout(() => {
                    modal.style.display = 'none';
                    window.location.href = 'login.html';
                }, 300);
            }
        }

        // إظهار إشعار
        function showNotification(message, type = 'info') {
            // إزالة أي إشعارات سابقة
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            // إنشاء عنصر الإشعار
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${message}</span>
                <button class="close-notification">&times;</button>
            `;

            // إضافة الإشعار إلى body
            document.body.appendChild(notification);

            // إضافة أنيميشن
            setTimeout(() => {
                notification.classList.add('show');
            }, 10);

            // إعداد إغلاق الإشعار
            const closeBtn = notification.querySelector('.close-notification');
            closeBtn.addEventListener('click', () => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            });

            // إزالة الإشعار تلقائياً بعد 5 ثوانٍ
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.classList.remove('show');
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                }
            }, 5000);
        }
    </script>
</body>


</html>
